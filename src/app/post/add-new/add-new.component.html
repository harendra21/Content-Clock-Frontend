<ng-container *ngIf="!loading">
  <div nz-row>
    <div nz-col nzMd="24" nzLg="15">
      
      <button type="button" class="btn-primary-icon" (click)="showModal()">
        <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 9a3 3 0 0 1 3-3m-2 15h4m0-3c0-4.1 4-4.9 4-9A6 6 0 1 0 6 9c0 4 4 5 4 9h4Z"/>
        </svg> &nbsp; Write With AI
      </button>

      <div class="mt-2">
        <textarea
          id="message"
          rows="8"
          class="textarea"
          placeholder="Post content..."
          [(ngModel)]="postContent"
        ></textarea>
        <div class="char-count text-right">{{ postContent.length }}</div>
      </div>
      <div class="mt-2">
        <app-upload-media
          [files]="files"
          (uploadedFiles)="uploadedFiles($event)"
        ></app-upload-media>
      </div>

      <ng-container *ngIf="connection.ConnectionName == 'pintrest_board'">
        <div class="mt-2">
          <input nz-input placeholder="Title" [(ngModel)]="title" type="text" />
        </div>
      </ng-container>

      <ng-container
        *ngIf="
          connection.ConnectionName == 'facebook_page' ||
          connection.ConnectionName == 'pintrest_board'
        "
      >
        <div class="mt-2">
          <input nz-input placeholder="Link" [(ngModel)]="link" type="text" />
        </div>
      </ng-container>

      <div nz-row>
        <div nz-col nzXs="24" nzSm="24" nzMd="8" nzLg="8">
          <div class="mt-2">
            <nz-date-picker
              nzShowTime
              nzFormat="yyyy-MM-dd HH:mm"
              [(ngModel)]="date"
              class="datepicker"
            ></nz-date-picker>
          </div>
        </div>
        <div nz-col nzXs="24" nzSm="24" nzMd="16" nzLg="16">
          <div class="mt-2 text-right">
            <button
              class="btn-success"
              nzType="default"
              (click)="schedulePost(true)"
            >
              Send Now
            </button>
            <button
              class="btn-warning"
              nzType="dashed"
              (click)="schedulePost(true)"
            >
              Draft
            </button>
            <button
              class="btn-primary"
              nzType="primary"
              (click)="schedulePost()"
            >
              Schedule
            </button>
          </div>
        </div>
      </div>
    </div>

    <div nz-col nzMd="24" nzLg="9">
      <div class="m-2">
        <ng-container *ngIf="connection.ConnectionName == 'twitter'">
          <app-twitter-card
            [name]="connection.Name"
            [profile_image]="connection.ProfileImage"
            [images]="images"
            [postDate]="date"
            [postContent]="postContent"
          ></app-twitter-card>
        </ng-container>

        <ng-container *ngIf="connection.ConnectionName == 'facebook_page'">
          <app-facebook-card
            [name]="connection.Name"
            [profile_image]="connection.ProfileImage"
            [images]="images"
            [postDate]="date"
            [postContent]="postContent"
          ></app-facebook-card>
        </ng-container>

        <ng-container *ngIf="connection.ConnectionName == 'linkedin_profile'">
          <app-linkedin-card
            [name]="connection.Name"
            [profile_image]="connection.ProfileImage"
            [images]="images"
            [postDate]="date"
            [postContent]="postContent"
          ></app-linkedin-card>
        </ng-container>

        <ng-container *ngIf="connection.ConnectionName == 'instagram'">
          <app-instagram-card
            [name]="connection.Name"
            [profile_image]="connection.ProfileImage"
            [images]="images"
            [postDate]="date"
            [postContent]="postContent"
          ></app-instagram-card>
        </ng-container>

        <ng-container *ngIf="connection.ConnectionName == 'pintrest_board'">
          <app-pinterest-card
            [name]="connection.Name"
            [profile_image]="connection.ProfileImage"
            [images]="images"
            [postDate]="date"
            [postContent]="postContent"
          ></app-pinterest-card>
        </ng-container>
      </div>
    </div>
  </div>

  <nz-modal
    nzDraggable
    nzCentered
    [(nzVisible)]="isVisible"
    nzTitle="Write With AI"
    (nzOnCancel)="handleCancel()"
    (nzOnOk)="handleOk()"
    [nzBodyStyle]="{
      'min-height': '200px'
    }"
    [nzFooter]="null"
  >
    <ng-container *nzModalContent>
      <app-ai-content
        (generatedContent)="generatedContent($event)"
      ></app-ai-content>
    </ng-container>
  </nz-modal>
</ng-container>

<div class="animation-container" *ngIf="loading">
  <lottie-player
    src="/assets/animations/loading.json"
    background="transparent"
    speed="1"
    loop
    autoplay
  >
  </lottie-player>
</div>
